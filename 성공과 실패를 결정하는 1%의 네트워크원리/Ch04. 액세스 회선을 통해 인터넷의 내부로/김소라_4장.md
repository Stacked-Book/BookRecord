## 01 ADSL 기술을 이용한 액세스 회선의 구조와 동작

---

💡 **ADSL(비대칭 디지털 가입자 회선, Asymmetric Digital Subscriver Line)이란?**

**일반 전화선을 사용하여 고속으로 데이터 통신**을 할 수 있는 기술인 DSL(Digital Subscriber Line) 중 하나로 **다운로드 회선**에 더 많은 대역폭을 할당한 것이 특징이다.

<br>

### 액세스 회선의 동작-1

<img width="595" alt="스크린샷 2022-06-23 오후 8 51 44" src="https://user-images.githubusercontent.com/80027033/175527438-b8263f78-caa0-4774-b3bb-3287a1a4525f.png">

①, ② 클라이언트에서 패킷을 만든다.

③ 패킷이 리피터 허브 혹은 스위칭 허브를 경유하여 `인터넷 접속용 라우터`에 도착한다.

④ 이더넷의 패킷에서 IP 패킷을 추출하여 중계 대상을 판단한다.

⑤ `PPP`, `PPPoE`, `MAC` 헤더를 붙여 `ADSL 모뎀`에 패킷을 보낸다.

⑥ 인터넷 접속용 라우터에서 송신한 패킷을 수신한다.

⑦ ASDL 모뎀은 패킷을 작게 분할하여 `셀`에 저장한다.

- 셀은 맨 앞 부분에 헤더(5바이트), 뒤에 데이터(48바이트)가 이어지는 작은 디지털 데이터 덩어리
- 셀은 ATM이라는 통신 기술에 사용

⑧ 셀에 저장한 다음 신호로 변환한다.

<br>

💡 **개념 정리**

- PPP(Point-to-Point Protocol) : 통신 이

  본인 확인, 설정값 통지, 데이터 압축, 암호화 등 다양한 기능 조합하여 사용 가능

- PPPoE(Point-to-Point Protocol over Ethernet) : 이더넷 프레임 안에 PPP 프레임을 넣어 만들 때 사용되는 통신 프로토콜
- ATM(Asynchronous Transfer Mode) : 전화 회선의 개념에 기초한 구형 전화 기술의 연장선에 있는 통신 방식

<br>

**ADSL의 신호 변환 방식**

ref. [http://synctech.co.kr/synctech/index.php/component/sppagebuilder/?view=page&id=51](http://synctech.co.kr/synctech/index.php/component/sppagebuilder/?view=page&id=51)

> LAN의 경우 사각형 신호를 이용해 디지털 데이터를 신호로 변환했지만 ADSL은 사각형 신호를 사용하지 않고 `직교 진폭 변조(QAM)` 방식을 사용한다.
>

<br>

🔎 **ADSL이 사각형 신호를 사용하지 않는 이유**

1. 사각형 신호는 파형이 뭉개지기 쉽고 거리가 떨어진 경우 오류를 일으키기 쉽다.
2. 넓은 범위의 주파수가 포함되어 있어 잡음을 제어하기 어렵다.

<br>

[신호 변조 방식](https://www.notion.so/c162fc84c19a46d5a614497ba24f722b)

- **ADSL이 신호 변조 방식을 이용해 고속화를 꾀하는 방법**
    - 주파수를 다르게 한 수백 개의 파를 사용하여 각각의 파에 직교 진폭 변조에 의해 비트값을 대응
    - 잡음이 없는 주파수의 파에는 다수의 비트 대응, 잡음이 있다면 소수의 비트 대응
- **업로드와 다운로드의 전송속도가 다른 이유**
    - 업로드는 26개의 파 사용, 다운로드는 95 or 223개의 파 사용
    - **트레이닝** : 모델의 전원을 공급할 때 시험 신호를 보내고, 이 수신 상태에 따라 파의 수나 비트 수 판단

<br>

### ADSL 모뎀에서 DSLAM 모뎀으로 가기까지

<img width="1158" alt="스크린샷 2022-06-24 오후 1 53 18" src="https://user-images.githubusercontent.com/80027033/175527640-a4cb838f-0f4c-459b-abfd-3f9c4bd100db.png">

① **스플리터**

> 들어온 **신호를 분리**하여 전화기측에 ADSL의 신호가 흐르지 않도록 한다.
>

<img width="613" alt="스크린샷 2022-06-24 오후 1 37 55" src="https://user-images.githubusercontent.com/80027033/175527739-9ad596e9-c8a3-4903-9d74-d222af0d402d.png">

- 일정한 주파수를 초과하는 신호를 차단하는 기능을 갖추고 있어 ADSL의 높은 주파수를 차단한다.
- 전화기에는 전화의 신호만 흐르고, DSL 모뎀으로 향하는 신호는 그대로 흐르게 된다.
- 스플리터의 앞에는 전화 케이블을 꽂은 모듈형 커넥터, **② 배선반**이 있고 밖에서 들어오는 배선과 건물의 배선이 함께 있다.

<br>

**③ 보안기**

> 전화선에서 과대한 전류가 흘러들지 않도록 보호한다.
>

<br>

**④ 전주(전신주)의 전화 케이블**

전화국에 가까워지면 지하 케이블을 모아서 매설한 부분인 **동도**를 통해 전화국에 들어간 케이블은 전화국의 MDF(Main Distribution Frame, 주 배선반)에 하나씩 연결된다.

💡 **전화 케이블을 통과할 때 잡음의 영향은?**

전화케이블은 ADSL의 높은 주파수의 신호를 흘리는 것을 가정하고 만든 것이 아니기 때문에 이더넷의 트위스트 페어 케이블보다 잡음의 영향을 받기 쉬우나 ADSL은 트위스트 페어 케이블처럼 즉시 오류가 발생하지 않는다. 즉, 속도의 저하가 발생한다.

<br>

### 액세스 회선의 동작-2

<img width="626" alt="스크린샷 2022-06-23 오후 8 51 53" src="https://user-images.githubusercontent.com/80027033/175527890-5194ae29-2634-4863-95d0-8f487df20441.png">

⑨ 전화 케이블을 통해 전화국에 도착한 신호가 `배선반`과 `스플리터`를 통과해 `DSLAM`에 도착한다.

⑩ 전기 신호가 디지털 데이터의 셀로 복원된다.

⑪ DSLAM을 나온 셀은 `BAS`에 도착한다.

⑫ 셀로부터 원래의 패킷으로 복원된다.

⑬ 수신한 패킷의 맨 앞부분에 있는 `MAC`, `PPPoE` 헤더를 버리고 `PPP` 헤더 이후의 부분을 추출한다.

⑭ 터널링용 헤더를 붙여 터널링의 출구를 향해 중계한다.

⑮ 패킷이 터널링의 출구에 있는 터널링용 라우터에 도착한다.

⑯ 터널링용 헤더를 분리하고 IP 패킷을 추출한다.

⑰ 인터넷의 내부에 중계한다.

💡 **개념 정리**

- **DSLAM**(DSL Access Multiplexer) : 다수의 ADSL 모뎀을 하나의 케이스에 넣은 기기
    - ADSL 모뎀과 달리 이더넷 대신 ATM 인터페이스가 있어 패킷을 분할한 셀 형태 그대로 후방의 라우터와 주고받는다.
- **BAS**(Broadband Access Server) : 패킷 중계 장치

<br>

## 02 광섬유를 이용한 액세스 회선(FTTH)

---

💡 **광섬유**

> 이중 구조의 가는 섬유질의 투명한 재질로 만들어져 있으며, 안쪽에 있는 코어 부분 속에 광신호를 흘려서 디지털 데이터를 전달한다. *등이 켜져 밝은 상태가 1을 나타내고, 어두운 상태가 0*을 나타낸다.
>

![cladding](https://user-images.githubusercontent.com/80027033/175528031-69ed8305-c935-4b66-abba-4d6fff980284.png)

- 클래드(clad) : 코어의 주변 부분이며 굴절률이 낮음.
- 코어 : 케이블의 중심 부분으로, 굴절률이 높음. 광신호는 이 부분을 통과함.

<br>

**광섬유를 이용한 통신의 원리**

① 디지털 데이터를 전기 신호로 변환한다.

② 전기 신호를 LED나 포토 다이오드 같은 광원에 입력하면 광원은 입력된 신호의 전압에 따라 빛을 발한다.

**③** 빛을 광섬유 안에 통과시키면 빛이 광섬유 안에서 진행되어 수신측에 도착한다.

④ `수광 소자`로 밝기에 따라 높고 낮은 전압의 전기 신호를 낸다.

- **수광소자** : 빛에 감응하여 밝기에 따라 전압을 일으키는 역할

⑤ 이 전기 신호를 디지털 데이터로 변환하여 데이터를 수신한다.

<br>

**③ 광섬유 속을 빛을 진행해 가는 모습**

광원에서 나온 빛이 광섬유의 코어 부분에 들어오는데 빛이 구석구석까지 흩어지므로 코어 부분에는 여러 각도의 빛이 들어간다. 입사각이 작은 빛만이 경계면에 전반사되어 코어속을 진행한다.

- 위상에 차이가 생기는 경우는 빛이 서로 상쇄되어 도중에 소멸되어 버리고, 위상에 차이가 없는 경우에만 광섬유 속을 진행한다.

  → **위상이 같은 각도로 입사된 소수의 빛만이 멀리 도달**

- 코어의 직경

  ![mode](https://user-images.githubusercontent.com/80027033/175528166-fc31a9e1-9a2d-4296-9dbe-fff73ee92193.png)

    - **싱글 모드** : 코어의 직경이 가늘고 위상이 같은 각도 중에서 가장 각도가 작은 빛만 들어가 코어 속을 진행
        - 수광 소자의 성능이 높아야 함
        - 반사각이 작아 신호의 변형이 적음
        - 멀리 떨어진 장소에 있는 건물 사이를 연결할 때 사용
    - **멀티 모드** : 코어의 직경이 굵고 입사각이 큰 빛도 들어가므로 **복수의 빛**이 코어 속을 진행
        - 빛의 양이 많다는 뜻으로 광원이나 수광 소자의 성능이 비교적 낮아도 상관없기 때문에 비용 절감
        - 주로 한 건물 안을 연결하는 용도로 사용

<br>

**FTTH 액세스 회선**

ASDL 대신 광섬유를 사용하여 사용자측의 인터넷 접속용 라우터와 인터넷 측의 BAS를 접속한다.

***두 가지 유형***

<img width="593" alt="스크린샷 2022-06-24 오후 4 22 14" src="https://user-images.githubusercontent.com/80027033/175528279-ab5a1f29-4019-4606-8715-3360998a959b.png">

1. **한 개의 광섬유로 사용자측과 가장 가까운 전화국측을 접속하는 유형**

① `미디어 컨버터`라는 장치에서 이더넷의 전기 신호를 광신호로 변환한다.

② 광신호는 미디어 컨버터에 연결된 광섬유 속으로 들가고 집합형의 미디어 컨버터에 도착한다.

③ `집합형 미디어 컨버터`에서 전기 신호로 복원되어 BAS의 포트가 수신하고 인터넷의 내부로 패킷을 중계한다.

🔎 **상향 광신호와 하향 광신호가 광섬유 속에서 혼합된다면?**

파장이 다른 빛은 혼합되어도 프리즘의 원리로 분리할 수 있다. 한 개의 광섬유를 사용하여 파장이 서로 다른 복수의 광신호를 흘리는 것을 **파장 다중**이라 한다.

<br>

<img width="600" alt="스크린샷 2022-06-24 오후 4 43 04" src="https://user-images.githubusercontent.com/80027033/175528395-7d8f76be-5252-4856-b0d6-30a259e703ab.png">

2. **사용자 부근의 전주에 `광스플리터`라는 분기 장치를 설치하고, 광섬유를 분기시켜 복수의 사용자를 연결하는 유형**

① `OLT`가 송신의 타이밍을 조정(패킷 충돌 방지)하여 `ONU`에 송신 지시를 내린다.

② ONU가 전기 신호를 광신호로 변환하여 송신 동작을 실행한다.

<br>

## 03 액세스 회선으로 이용하는 PPP와 터널링

---

**BAS의 기능**

- **본인 확인**
    - 인터넷에 액세스하기 위해 사용자명과 패스워드 입력
    - BAS는 `다이얼업 접속`으로 이용하는 `PPP` 구조를 발전시킨 `PPPoE`를 사용
- **설정값 통지**
    - PC에 TCP/IP의 설정 정보를 통지, 그 중에 포함된 글로벌 주소를 PC에 설정
- **`터널링`이라는 개념을 사용하여 패킷 운반**
    - 한쪽의 터널링 출입구에 헤더를 포함한 패킷 전체를 넣으면 그대로의 모습으로 반대쪽 출입구에 도닥


🔎 **다이얼업 접속의 PPP를 그대로 ADSL이나 FTTH로 사용할 수 없는 이유**

PPP 메시지를 저장하기 위해 `HDLC`라는 프로토콜을 사용하는데 ADSL이나 FTTH는 사용할 수 없다. 그래서 HDLC 대신 ***이더넷 패킷**을 사용하기 위해 새로 만든 사양*을 `PPPoE`라고 부른다.

<br>

**액세스 회선 전체의 동작(PPPoE)**

① 사용자측에 인터넷 접속용 라우터에 프로바이더가 할당한 사용자명과 패스워드를 등록한다.

② 인터넷 접속용 라우터는 PPPoEdml Discovery라는 구조에 따라 BAS를 찾는다.

- BAS의 MAC 주소를 브로드캐스트를 이용하여 찾음

③ PAP/CHAP에 의한 본인 확인으로 BAS에 사용자명과 패스워드를 보낸다.

- PAP : 패스워드를 암호화하지 않음
- CHAP : 패스워드 암호화

④ 패스워드를 확인한 후 BAS에서 사용자에 대해 TCP/IP의 설정 정보를 통지한다.

- 인터넷에 접속하는 기기에 할당한 IP 주소, DNS 서버의 IP 주소, 기본 게이트웨이의 IP 주소
- BAS가 통지한 설정 정보를 라우터가 받기 때문에 PC에 글로벌 주소를 할당할 수 없으므로 PC에는 프라이비트 주소를 할당하고 PC가 보낸 패킷은 인터넷 접속용 라우터에서 **주소 변환** 후 인터넷에 중계

⑤ 이 설정 정보를 인터넷 접속용 라우터가 받아 라우터 자체에 설정하여 패킷을 인터넷에 중계할 수 있는 상태로 만든다.

💡 **언넘버드란?**

Discovery를 경유하여 BAS와 대화하는 단계에 들어가면 논리적인 통신 형태는 1 대 1이 되고 하나의 케이블이 연결되어있는 상태에서는 한쪽에서 송신된 패킷이 여지없이 반대편에 도착하므로 중계 대상의 주소를 조사하는 동작이 필요없다. 이때 **포트에 IP주소를 할당하지 않는 것**이 `언넘버드(unnumbered)`이다.

<br>

**PPPoA(Point-to-Point over ATM)**

> MAC 헤더와 PPPoE 헤더를 붙이지 않고 패킷을 그대로 저장한다.
>
- PC나 라우터를 ADSL 모뎀과 일체화해야 구조가 동작한다.
- **장점** : 이더넷의 패킷을 사용하지 않으므로 MTU가 짧아지지 않고 효율성이 떨어지지 않는다.
- **단점** : ADSL 모뎀과 라우터를 분리할 수 없다.

  ⇒ PPP를 사용하지 않고 이더넷의 패킷을 그대로 ADSL 신호로 변환하여 DSLAM에 송신하는 `DHCP` (Dynamic Host Configuration Protocol)방식도 있다.

<br>

## 04 프로바이더의 내부

---

1. 액세스 회선을 통과한 패킷은 프로바이더의 `POP`에 설치된 라우터에 도착한다.
- 액세스 회선의 종류에 따라 *여러 유형의 라우터*를 구분하여 사용
2. `NOC`는 프로바이더의 핵심이 되는 설비로서 POP에서 들어온 패킷이 여기에 모여든다.
- 이곳에서 목적지 근처에 있는 POP나 다른 프로바이더로 패킷이 흘러가는데, 여기에도 고성능의 라우터가 설치
- NOC와 POP는 엄밀하게 구분할 수 없다.

<br>

**건물 밖의 접속**

> 프로바이더의 네트워크는 흐르는 패킷의 양이 매우 많아서 트위스트 페어 케이블로 취급할 수 있는 한계를 초과하는 경우도 있는데, 이 부분에 광섬유 케이블을 사용한다.
>

<br>

**멀리 떨어진 장소에 있는 NOC/POP를 연결하는 방법**

- 자사에서 광섬유를 소유하고 있는 경우

  광섬유를 사용하여 먼 장소에 있는 NOC나 POP를 연결

- 광섬유를 소유하지 않고 있는 경우

  광섬유를 소유하고 있는 회사의 광섬유를 세분화하여 그 일부를 대출(**`통신 회선`**)하여 NOC나 POP 연결

<br>

## 05 프로바이더를 경유하여 흐르는 패킷

---

> 최종 목적지가 되는 웹 서버가 클라이언트와 같은 프로바이더에 접속되어 있거나 혹은 그렇지 않더라도 모든 경로가 라우터에 등록되어 있으므로 계속해서 경로표에 있는 중계 대상을 찾아가면 웹 서버측의 POP에 패킷을 도착하게 할 수 있다.
>

<br>

**프로바이더끼리 경로 정보 교환하기**

접속 상대가 경로 정보를 가르쳐주면 정보를 경로표에 등록한다. 상대가 경로 정보를 가르쳐주면 이쪽에서도 같은 방법으로 상대에게 경로 정보를 통지한다.

**두 가지 유형**

- 인터넷의 경로를 전부 상대에게 통지하는 것
    - **`트랜지트`** : 인터넷의 모든 프로바이더에 패킷을 보낼 수 있음
- 각각의 네트워크에 관한 경로 정보만 상대에게 통지하는 것
    - `비트랜지트/피어(Peer)` : 서로 상대의 네트워크로 갈 패킷만 흐름

💡 개념 정리

- BGP(Border Gateway Protocol) : 라우터가 자동으로 수행하는 경로 정보 교환에 사용하는 구조

<br>

**사내 네트워크에서 자동 등록하기**

> 프로바이더 간의 경로 정보 교환은 특정 라우터와 1 대 1로 이루어지지만 사내에서는 무차별 적으로 모든 라우터와 정보 교환을 해서 최단 경로를 찾아 패킷을 중계한다.
>

<br>

**IX의 필요성**

> 프로바이더끼리 1 대 1로 접속하는 방법 뿐이라면 모든 프로바이더와 통신 회선을 연결해야 하므로 `IX`라는 중심 설비를 두어 이것을 경유하여 접속하게 해 통신 회선의 수를 억제한다.
>
- 건물 어딘가에 IX가 있고 IX의 중심에는 고속 LAN의 인터페이스를 다수 장착한 `레이어 2 스위치`가 있다.
- **프로바이더의 라우터 연결 방법**
    - IX와 같은 건물에 NOC를 설치한 프로바이더라면, NOC에서 광섬유 케이블을 가설하여 IX의 스위치에 접속한다.
    - 프로바이더가 라우터를 통신 회선 등을 통해 스위치에 접속한다.
    - 프로바이더가 라우터를 IX에 가지고 들어가 스위치에 접속한다.
    - 데이터센터 등 패킷의 흐름이 집중되는 장소에 IX의 목적지가 되는 스위치를 설치하고 여기에 프로바이더의 라우터를 가지고 연결한다.